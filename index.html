<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Mattia Astori</title>
  <link rel="icon" type="image/webp" href="assets/favicon_chaos.webp">
  <link rel="apple-touch-icon" href="assets/favicon_chaos.webp">
  <link rel="stylesheet" href="assets/fonts.css">
  <link rel="stylesheet" href="assets/styles.css">
</head>

<body>
  <!-- Mobile Menu Button -->
  <button class="mobile-menu" onclick="toggleMobileMenu()">Menu</button>

  <div class="container">
    <!-- Mobile Header -->
    <div class="mobile-header">
      <div class="mobile-top">
        <a href="/" class="mobile-logo">Mattia Astori</a>
        <a href="/about" class="mobile-about">About</a>
      </div>
      <div class="mobile-socials">
        <a href="https://instagram.com/astori.teller" target="_blank" title="Instagram">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
            <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
          </svg>
        </a>
        <a href="https://linkedin.com/in/mattiaastori" target="_blank" title="LinkedIn">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
            <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
          </svg>
        </a>
        <a href="mailto:mattiastori@gmail.com" title="Email">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="16" height="16">
            <path d="M0 3v18h24v-18h-24zm21.518 2l-9.518 7.713-9.518-7.713h19.036zm-19.518 14v-11.817l10 8.104 10-8.104v11.817h-20z"/>
          </svg>
        </a>
      </div>
    </div>

    <!-- Left Sidebar - Exact Match -->
    <aside class="sidebar" id="sidebar">
      <a href="/" class="logo">Mattia Astori</a>
      <nav class="nav">
        <a href="/about">About</a>
        <div class="social-icons">
          <a href="https://instagram.com/astori.teller" target="_blank" title="Instagram">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z"/>
            </svg>
          </a>
          <a href="https://linkedin.com/in/mattiaastori" target="_blank" title="LinkedIn">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/>
            </svg>
          </a>
          <a href="mailto:mattiastori@gmail.com" title="Email">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
              <path d="M0 3v18h24v-18h-24zm21.518 2l-9.518 7.713-9.518-7.713h19.036zm-19.518 14v-11.817l10 8.104 10-8.104v11.817h-20z"/>
            </svg>
          </a>
        </div>
      </nav>
      <div class="image-title" id="image-title"></div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Home Section (Gallery) -->
      <div class="gallery-container" id="home-section">
        <span class="thumbnails-toggle" onclick="toggleThumbnails()">show all photos</span>
        
        <div class="gallery">
          <!-- Macha Series -->
          <div class="slide active">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-rope-guy.webp" alt="Macha Series - Rope Guy">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-purple-rope-guy.webp" alt="Macha Series - Purple Rope Guy">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-moving-punch.webp" alt="Macha Series - Moving Punch">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-missing-eye.webp" alt="Macha Series - Missing Eye">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-hat-lady.webp" alt="Macha Series - Hat Lady">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-girl.webp" alt="Macha Series - Girl">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-coca-punch.webp" alt="Macha Series - Coca Punch">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-broken-nose.webp" alt="Macha Series - Broken Nose">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-punch.webp" alt="Macha Series - Punch">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/macha-policia.webp" alt="Macha Series - Policia">
          </div>

          <!-- Tultepec Series -->
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-sinaloa.webp" alt="Tultepec Series - Sinaloa">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-sinaloa-rocket.webp" alt="Tultepec Series - Sinaloa Rocket">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-push.webp" alt="Tultepec Series - Push">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-phone.webp" alt="Tultepec Series - Phone">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-milky-way.webp" alt="Tultepec Series - Milky Way">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-hooligan.webp" alt="Tultepec Series - Hooligan">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-guy-back.webp" alt="Tultepec Series - Guy Back">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-fire.webp" alt="Tultepec Series - Fire">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-everyone-carrying.webp" alt="Tultepec Series - Everyone Carrying">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-chaos-vertical.webp" alt="Tultepec Series - Chaos Vertical">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-chaos-horizontal.webp" alt="Tultepec Series - Chaos Horizontal">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-bull.webp" alt="Tultepec Series - Bull">
          </div>

          <!-- Tultepec Day Series -->
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-day-kid-horizontal.webp" alt="Tultepec Day Series - Kid Horizontal">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-day-chihuahua.webp" alt="Tultepec Day Series - Chihuahua">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-day-bench-guy.webp" alt="Tultepec Day Series - Bench Guy">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/tultepec-day-baby.webp" alt="Tultepec Day Series - Baby">
          </div>

          <!-- Australia Series -->
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/australia-kangaroo.webp" alt="Australia Series - Kangaroo">
          </div>
          <div class="slide">
            <div class="nav-zone left" onclick="changeSlide(-1)"></div>
            <div class="nav-zone right" onclick="changeSlide(1)"></div>
            <img src="assets/images/australia-chair.webp" alt="Australia Series - Chair">
          </div>
        </div>

        <!-- Navigation Controls - Below the image -->
        <div class="controls-container">
          <button class="control-btn" onclick="changeSlide(-1)">prev</button>
          <span class="separator">/</span>
          <button class="control-btn" onclick="changeSlide(1)">next</button>
        </div>

        <!-- Thumbnails -->
        <div class="thumbnails-container">
          <div class="thumbnails" id="thumbnails">
            <!-- Generated by JavaScript -->
          </div>
        </div>
      </div>
    </main>
  </div>

  <script>
    let currentSlide = 0;
    let showingThumbnails = false;

    const slides = document.querySelectorAll('.slide');
    const totalSlides = slides.length;

    // Image data
    const imageData = [
      // Macha series
      { src: 'assets/images/macha-rope-guy.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-purple-rope-guy.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-moving-punch.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-missing-eye.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-hat-lady.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-girl.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-coca-punch.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-broken-nose.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-punch.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      { src: 'assets/images/macha-policia.webp', title: 'Tinku de Macha, Bolivia', year: '2025' },
      
      // Tultepec series
      { src: 'assets/images/tultepec-sinaloa.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-sinaloa-rocket.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-push.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-phone.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-milky-way.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-hooligan.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-guy-back.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-fire.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-everyone-carrying.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-chaos-vertical.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-chaos-horizontal.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-bull.webp', title: 'Feria Internacional de la Pirotecnìa, Mexico', year: '2025' },
      
      // Tultepec Day series
      { src: 'assets/images/tultepec-day-kid-horizontal.webp', title: 'Tultepec, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-day-kid-and-sister.webp', title: 'Tultepec, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-day-bench-guy.webp', title: 'Tultepec, Mexico', year: '2025' },
      { src: 'assets/images/tultepec-day-baby.webp', title: 'Tultepec, Mexico', year: '2025' },

      // Australia series
      { src: 'assets/images/australia-kangaroo.webp', title: 'Australia', year: '2024' },
      { src: 'assets/images/australia-chair.webp', title: 'Australia', year: '2024' }
    ];

    // Initialize the gallery
    function initGallery() {
      generateThumbnails();
      updateSlide();
      handleResponsiveLayout();

      // Add window resize listener
      window.addEventListener('resize', handleResponsiveLayout);
    }

    // Handle responsive layout
    function handleResponsiveLayout() {
      const container = document.querySelector('.gallery-container');
      const thumbnails = document.getElementById('thumbnails');
      const gallery = document.querySelector('.gallery');
      const controls = document.querySelector('.controls-container');
      const toggleButton = document.querySelector('.thumbnails-toggle');

      if (window.innerWidth <= 768) {
        // Mobile layout
        container.classList.add('showing-thumbnails');
        thumbnails.classList.add('show');
        gallery.style.display = 'none';
        controls.style.display = 'none';
        if (toggleButton) toggleButton.style.display = 'none';
      } else if (window.innerWidth <= 1366) {
        // Laptop layout
        container.classList.remove('showing-thumbnails');
        thumbnails.classList.remove('show');
        gallery.style.display = 'flex';
        controls.style.display = 'flex';
        if (toggleButton) toggleButton.style.display = 'block';
        
        // Adjust masonry layout for laptop screens
        if (window.innerWidth <= 1200) {
          layoutMasonry(2); // 2 columns for smaller laptops
        } else {
          layoutMasonry(3); // 3 columns for larger laptops
        }
      } else {
        // Desktop layout
        container.classList.remove('showing-thumbnails');
        thumbnails.classList.remove('show');
        gallery.style.display = 'flex';
        controls.style.display = 'flex';
        if (toggleButton) toggleButton.style.display = 'block';
        layoutMasonry(3); // 3 columns for desktop
      }
    }

    // Generate thumbnails
    function generateThumbnails() {
      const thumbnailsContainer = document.getElementById('thumbnails');
      thumbnailsContainer.innerHTML = '';

      imageData.forEach((image, index) => {
        const thumbnail = document.createElement('div');
        thumbnail.className = 'thumbnail';
        thumbnail.onclick = () => {
          if (window.innerWidth > 768) {
            goToSlide(index);
          }
        };

        const img = document.createElement('img');
        img.src = image.src;
        img.alt = image.title;
        
        // Add load event to trigger masonry layout
        img.onload = () => {
          if (window.innerWidth > 768) {
            layoutMasonry();
          }
        };

        thumbnail.appendChild(img);
        thumbnailsContainer.appendChild(thumbnail);
      });
    }

    // Masonry layout function
    function layoutMasonry(columnCount = 3) {
      if (window.innerWidth <= 768) {
        // Reset any masonry styles on mobile
        const container = document.getElementById('thumbnails');
        const thumbnails = container.querySelectorAll('.thumbnail');
        thumbnails.forEach(thumbnail => {
          thumbnail.style.width = '';
          thumbnail.style.left = '';
          thumbnail.style.top = '';
        });
        container.style.height = '';
        return;
      }
      
      const container = document.getElementById('thumbnails');
      const thumbnails = container.querySelectorAll('.thumbnail');
      
      if (thumbnails.length === 0) return;
      
      const containerWidth = container.offsetWidth;
      const gap = 20;
      const columnWidth = (containerWidth - (gap * (columnCount - 1))) / columnCount;
      
      // Initialize column heights
      const columnHeights = new Array(columnCount).fill(0);
      
      thumbnails.forEach((thumbnail, index) => {
        const img = thumbnail.querySelector('img');
        if (!img.complete) return; // Skip if image not loaded
        
        // Calculate which column to place this thumbnail in
        const shortestColumnIndex = columnHeights.indexOf(Math.min(...columnHeights));
        
        // Set thumbnail size and position
        thumbnail.style.width = `${columnWidth}px`;
        thumbnail.style.left = `${shortestColumnIndex * (columnWidth + gap)}px`;
        thumbnail.style.top = `${columnHeights[shortestColumnIndex]}px`;
        
        // Calculate the aspect ratio and height
        const aspectRatio = img.naturalHeight / img.naturalWidth;
        const thumbnailHeight = columnWidth * aspectRatio;
        
        // Update column height
        columnHeights[shortestColumnIndex] += thumbnailHeight + gap;
      });
      
      // Set container height
      const maxHeight = Math.max(...columnHeights);
      container.style.height = `${maxHeight}px`;
    }

    // Change slide
    function changeSlide(direction) {
      currentSlide += direction;
      if (currentSlide >= totalSlides) currentSlide = 0;
      if (currentSlide < 0) currentSlide = totalSlides - 1;
      updateSlide();
    }

    // Go to specific slide
    function goToSlide(index) {
      currentSlide = index;
      updateSlide();

      // Close thumbnails when selecting
      if (showingThumbnails) {
        toggleThumbnails();
      }
    }

    // Update slide display
    function updateSlide() {
      slides.forEach((slide, index) => {
        slide.classList.toggle('active', index === currentSlide);
      });

      // Update thumbnails
      const thumbnails = document.querySelectorAll('.thumbnail');
      thumbnails.forEach((thumbnail, index) => {
        thumbnail.classList.toggle('active', index === currentSlide);
      });

      // Update image title
      const imageTitle = document.getElementById('image-title');
      imageTitle.innerHTML = `<div class="image-year">${imageData[currentSlide].year}</div>${imageData[currentSlide].title}`;
    }

    // Toggle thumbnails view - only for desktop
    function toggleThumbnails() {
      if (window.innerWidth <= 768) return;
      
      const thumbnailsContainer = document.getElementById('thumbnails');
      const toggleButton = document.querySelector('.thumbnails-toggle');
      const gallery = document.querySelector('.gallery');
      const controls = document.querySelector('.controls-container');
      const container = document.querySelector('.gallery-container');
      const imageTitle = document.getElementById('image-title');

      showingThumbnails = !showingThumbnails;
      thumbnailsContainer.classList.toggle('show', showingThumbnails);
      toggleButton.textContent = showingThumbnails ? 'hide all photos' : 'show all photos';
      container.classList.toggle('showing-thumbnails', showingThumbnails);
      imageTitle.classList.toggle('hidden', showingThumbnails);
      
      gallery.style.display = showingThumbnails ? 'none' : 'flex';
      controls.style.display = showingThumbnails ? 'none' : 'flex';
      
      // Trigger masonry layout when showing thumbnails
      if (showingThumbnails) {
        setTimeout(layoutMasonry, 50); // Small delay to ensure display change is applied
      }
    }

    // Toggle mobile menu
    function toggleMobileMenu() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('mobile-open');
    }

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (document.getElementById('home-section').style.display !== 'none') {
        if (e.key === 'ArrowLeft') changeSlide(-1);
        if (e.key === 'ArrowRight') changeSlide(1);
      }
    });

    // Touch/swipe support
    let touchStartX = 0;
    let touchEndX = 0;

    document.addEventListener('touchstart', (e) => {
      touchStartX = e.changedTouches[0].screenX;
    });

    document.addEventListener('touchend', (e) => {
      touchEndX = e.changedTouches[0].screenX;
      handleSwipe();
    });

    function handleSwipe() {
      const swipeThreshold = 50;
      const diff = touchStartX - touchEndX;

      if (Math.abs(diff) > swipeThreshold && document.getElementById('home-section').style.display !== 'none') {
        if (diff > 0) {
          changeSlide(1);
        } else {
          changeSlide(-1);
        }
      }
    }

    // Initialize when page loads
    document.addEventListener('DOMContentLoaded', initGallery);
  </script>
</body>

</html>